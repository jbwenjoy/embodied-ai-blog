---
layout: article
title: LAPA
permalink: /lapa/
---






## **ğŸ§  ä¸€ã€æˆ‘ä»¬æƒ³è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ**

å’±ä»¬åšæœºå™¨äººè®­ç»ƒæ—¶ï¼Œæœ€ç†æƒ³çš„æƒ…å†µæ˜¯ï¼š

- æ‹¥æœ‰å¤§é‡å›¾åƒ + åŠ¨ä½œå¯¹ï¼ˆæ¯”å¦‚ï¼šå›¾åƒæ˜¯â€œä½ çœ‹åˆ°æ¡Œå­ä¸Šçš„æ¯å­â€ï¼ŒåŠ¨ä½œæ˜¯â€œæŠ“å–æ¯å­â€ï¼‰

ä½†è¿™ä¸ªä»£ä»·å¤ªé«˜äº†ï¼Œå› ä¸ºï¼š

- æ¯ä¸€ä¸ªåŠ¨ä½œéƒ½éœ€è¦é¥æ“ä½œè®°å½•ï¼Œæˆæœ¬é«˜ã€æ•°æ®å°‘ã€‚
- ç½‘ä¸Šè™½ç„¶æœ‰æ— æ•°è§†é¢‘ï¼ˆæ¯”å¦‚åšé¥­ã€æ‰“æ‰«ç­‰ï¼‰ï¼Œä½†éƒ½æ²¡æœ‰åŠ¨ä½œæ ‡ç­¾ã€‚

æ‰€ä»¥è¿™ç¯‡è®ºæ–‡è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯ï¼š

> **â€œæˆ‘å¯ä¸å¯ä»¥åªç”¨è§†é¢‘ï¼ˆå›¾åƒ+è¯­è¨€ï¼‰ï¼Œå°±å­¦å‡ºâ€˜åˆç†çš„åŠ¨ä½œè¡¨ç¤ºâ€™ï¼Œç„¶åå°‘é‡å¾®è°ƒå°±èƒ½ç”¨åœ¨æœºå™¨äººä¸Šï¼Ÿâ€**

## **ğŸ§© äºŒã€ä»–ä»¬æ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿâ€”â€”3ä¸ªé˜¶æ®µï¼**

è¿™ç¯‡è®ºæ–‡çš„æ–¹æ³•å«åš **LAPA**ï¼Œæ ¸å¿ƒæ˜¯ä¸‰ä¸ªé˜¶æ®µï¼š

### **âœ… Step 1ï¼š**

### **ä»è§†é¢‘ä¸­å­¦â€œæ½œåœ¨åŠ¨ä½œâ€**

å°±åƒå­¦è¯­è¨€ä¹‹å‰æˆ‘ä»¬è¦çŸ¥é“â€œå•è¯â€ï¼Œä»–ä»¬çš„ç¬¬ä¸€æ­¥æ˜¯ï¼š

> **èƒ½ä¸èƒ½ä»å›¾åƒå¯¹ï¼ˆæ¯”å¦‚å½“å‰å¸§ã€ä¸‹ä¸€å¸§ï¼‰ä¸­æå–å‡ºâ€œç¦»æ•£çš„åŠ¨ä½œâ€è¡¨ç¤ºï¼Ÿ**

ä»–ä»¬çš„åšæ³•æ˜¯ï¼š

- ç”¨ä¸€ä¸ª**VQ-VAE**æ¨¡å‹æ¥å­¦ä¹ å¸§ä¹‹é—´çš„â€œåŠ¨ä½œå˜åŒ–â€ï¼Œå¹¶é‡åŒ–ä¸ºä¸€ä¸ªç¦»æ•£ tokenã€‚
- è¿™ä¸ª token å¯ä»¥ç†è§£ä¸ºï¼šè§†é¢‘ä¸­è¿™ä¸ªæ—¶åˆ»å‘ç”Ÿäº†æŸä¸ª**åŸå­åŠ¨ä½œ**ï¼Œæ¯”å¦‚â€œæ‰‹å¾€å³ç§»åŠ¨ä¸€ç‚¹â€æˆ–è€…â€œæ‰‹ä¸‹å‹ä¸€ç‚¹â€ã€‚

**è¿™ä¸ªé˜¶æ®µå¾—åˆ°çš„ï¼šæ˜¯ä¸€ä¸ªâ€œæ½œåœ¨åŠ¨ä½œç¼–ç å™¨â€ï¼Œå¯ä»¥æŠŠè§†é¢‘å¸§å·®å¼‚ç¼–ç ä¸ºä¸€ä¸²ç¦»æ•£åŠ¨ä½œ tokenã€‚**

### **âœ… Step 2ï¼š**

### **è®­ç»ƒä¸€ä¸ªâ€œæ½œåœ¨åŠ¨ä½œæ¨¡å‹â€**

ç°åœ¨æˆ‘ä»¬æŠŠäº’è”ç½‘ä¸Šçš„â€œæœºå™¨äººè§†é¢‘â€ã€â€œäººç±»è§†é¢‘â€éƒ½å–‚è¿›å»ï¼Œç”¨åˆšæ‰å­¦åˆ°çš„ç¼–ç å™¨æ ‡æ³¨å‡ºæ½œåœ¨åŠ¨ä½œåºåˆ—ï¼ˆè™½ç„¶ä¸æ˜¯çœŸå®åŠ¨ä½œï¼Œä½†ä»£è¡¨è¡Œä¸ºå˜åŒ–ï¼‰ã€‚

ç„¶åè®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œè¾“å…¥æ˜¯ï¼š

- å½“å‰å›¾åƒ
- è‡ªç„¶è¯­è¨€æŒ‡ä»¤

è¾“å‡ºæ˜¯ï¼š

- ä¸€ä¸²æ½œåœ¨åŠ¨ä½œ token

è¿™ä¸ªè¿‡ç¨‹å°±åƒæ˜¯è®­ç»ƒä¸€ä¸ªè¯­è¨€æ¨¡å‹ä¸€æ ·ï¼Œé¢„æµ‹â€œåŠ¨ä½œåºåˆ—â€ã€‚

è¿™ä¸€æ­¥æ²¡æœ‰ç”¨çœŸå®åŠ¨ä½œï¼Œä»…ç”¨â€œæ½œåœ¨åŠ¨ä½œâ€ã€‚

### **âœ… Step 3ï¼š**

### **åœ¨å°‘é‡çœŸå®æœºå™¨äººæ•°æ®ä¸Šå¾®è°ƒ**

æœ€åï¼Œä¸ºäº†è®©è¿™ä¸ªæ½œåœ¨åŠ¨ä½œåºåˆ—çœŸæ­£è½¬ä¸ºâ€œæœºå™¨äººèƒ½æ‰§è¡Œçš„è¿ç»­åŠ¨ä½œâ€ï¼Œæˆ‘ä»¬åªéœ€è¦ï¼š

- ç”¨å°è§„æ¨¡çœŸå®æœºå™¨äººæ•°æ®ï¼Œå­¦ä¸€ä¸ª**å°çš„æ˜ å°„æ¨¡å‹**ï¼šæŠŠæ½œåœ¨åŠ¨ä½œ â†’ çœŸå®åŠ¨ä½œã€‚

è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†â€œä»æ— æ ‡ç­¾è§†é¢‘ â†’ å­¦åŠ¨ä½œè¡¨ç¤º â†’ å°‘é‡å¾®è°ƒ â†’ çœŸæ­£éƒ¨ç½²â€ã€‚

## **ğŸ§ª å®éªŒç»“æœä¸Šæœ‰ä»€ä¹ˆäº®ç‚¹ï¼Ÿ**

ä»–ä»¬åœ¨ä¸‰ä¸ªåœºæ™¯ä¸­åšå®éªŒï¼š

1. **è·¨ä»»åŠ¡**ï¼šè®­ç»ƒä»»åŠ¡Aï¼Œæµ‹è¯•ä»»åŠ¡Bï¼ˆæ¨¡å‹æ³›åŒ–æ€§å¥½ï¼‰
2. **è·¨ç¯å¢ƒ**ï¼šæ¢ä¸åŒç¯å¢ƒï¼ˆæ¯”å¦‚æ¢é¢œè‰²ã€æ¢èƒŒæ™¯ï¼‰
3. **è·¨å½¢æ€**ï¼šäººç±»è§†é¢‘ â†’ æœºå™¨äººåŠ¨ä½œ

ä»–ä»¬å‘ç°ï¼š

- LAPA æ¯”å¾ˆå¤š baselineï¼ˆåŒ…æ‹¬ç”¨çœŸå®åŠ¨ä½œè®­ç»ƒçš„ï¼‰éƒ½æ›´ç¨³ï¼Œæ›´æ³›åŒ–ã€‚
- å³ä½¿åªç”¨äººç±»è§†é¢‘æ¥é¢„è®­ç»ƒï¼Œä¹Ÿèƒ½ transfer åˆ°æœºå™¨äººåŠ¨ä½œä¸Šã€‚



![Refer to caption](../_pages/assetsx2-20250407223623368.png)

## **ğŸ¯ æ€»ä½“ç»“æ„ï¼šä¸‰éƒ¨åˆ†ã€ä¸¤ä¸ªé˜¶æ®µ**

- å·¦è¾¹ï¼š**Latent Action Pretraining**ï¼ˆæ½œåœ¨åŠ¨ä½œé¢„è®­ç»ƒï¼‰åˆ†ä¸ºä¸¤æ­¥
- å³è¾¹ï¼š**Action Finetuning**ï¼ˆåŠ¨ä½œå¾®è°ƒï¼‰æ‰ç”¨åˆ°çœŸå®æœºå™¨äººåŠ¨ä½œ

## **ğŸ§© Step 1: Latent Action Quantization ï¼ˆæ½œåœ¨åŠ¨ä½œé‡åŒ–ï¼‰**

### **è®­ç»ƒé˜¶æ®µï¼š**

- è¾“å…¥ï¼šä¸¤ä¸ªè¿ç»­çš„è§†é¢‘å¸§ x_1, x_2ï¼ˆæ¯”å¦‚ï¼šæ‰‹æŒ‡é è¿‘ç“¶å­ â†’ ç“¶å­å€’äº†ï¼‰
- æ¨¡å‹ç»“æ„ï¼š
  - **Encoder**ï¼šæŠŠ x_1, x_2 è¾“å…¥åï¼Œè¾“å‡ºä¸€ä¸ªå‘é‡è¡¨ç¤º z_1ï¼Œè¡¨ç¤ºâ€œä» x1 åˆ° x2 çš„å˜åŒ–â€
  - ç„¶åå°† z_1 æ˜ å°„åˆ°æœ€è¿‘çš„ä¸€ä¸ª**codebook ä¸­çš„ç¦»æ•£ token**ï¼ˆæ¯”å¦‚ token 2ï¼‰
  - **Decoder**ï¼šæ¥æ”¶ x_1 å’Œ token 2ï¼Œé‡å»ºå‡º x_2

### **è®­ç»ƒç›®æ ‡ï¼š**

- è®© decoder é‡å»ºçš„ \hat{x}_2 å°½å¯èƒ½æ¥è¿‘çœŸå®çš„ x_2
- åŒæ—¶ä¿æŒ token ç¦»æ•£ã€ç¨€ç–ï¼ˆVQ-VAE lossï¼‰

### **æ¨ç†é˜¶æ®µï¼š**

- æ¨¡å‹å›ºå®šï¼Œç”¨æ¥æŠŠä»»æ„å¸§å¯¹ç¼–ç ä¸ºç¦»æ•£åŠ¨ä½œ token
- å¾—åˆ°çš„æ˜¯ä¸€ç§â€œæ½œåœ¨åŠ¨ä½œè¡¨ç¤ºâ€ z_1ï¼Œç¦»æ•£çš„æ•´æ•° token

> âœ… **ç›®çš„æ˜¯ï¼šæŠŠâ€œè§†è§‰ä¸Šçš„å˜åŒ–â€å­¦æˆç¦»æ•£çš„æ½œåœ¨åŠ¨ä½œ token**ï¼Œä½œä¸ºåé¢è®­ç»ƒçš„â€œä¼ªåŠ¨ä½œæ ‡ç­¾â€

## **ğŸ§© Step 2: Latent Pretraining ï¼ˆæ½œåœ¨åŠ¨ä½œé¢„è®­ç»ƒï¼‰**

è¿™ä¸ªéƒ¨åˆ†å¼€å§‹ç”¨è¯­è¨€å•¦ï¼

### **è®­ç»ƒé˜¶æ®µï¼š**

- è¾“å…¥ï¼š
  - å½“å‰å›¾åƒ x_1
  - è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼ˆæ¯”å¦‚ â€œKnock down the water bottleâ€ï¼‰
- æ¨¡å‹æ˜¯ï¼š**VLMï¼ˆVision-Language Modelï¼‰**
  - ç±»ä¼¼ Flamingoã€BLIPã€M3AE ç­‰ç»“æ„
- è¾“å‡ºï¼š
  - é¢„æµ‹æ½œåœ¨åŠ¨ä½œ token z_1ï¼Œæ¥è‡ª Step 1 å­¦å‡ºæ¥çš„ codebook

> âœ… **ç›®çš„æ˜¯ï¼šè®©æ¨¡å‹å­¦ä¼šâ€œçœ‹å›¾+å¬è¯­è¨€â€ â†’ çŒœåº”è¯¥æ‰§è¡Œå“ªä¸ªæ½œåœ¨åŠ¨ä½œ**

### **æ¨ç†é˜¶æ®µï¼š**

- è¾“å…¥ä¸€å¼ å›¾ + ä¸€ä¸ªä»»åŠ¡
- è¾“å‡ºä¸€ä¸²æ½œåœ¨åŠ¨ä½œ tokenï¼Œç±»ä¼¼â€œåŠ¨ä½œè¯­è¨€â€

## **ğŸ§© Step 3: Action Finetuning ï¼ˆåŠ¨ä½œå¾®è°ƒï¼‰**

è¿™ä¸€æ­¥æ‰æ˜¯è®©æœºå™¨äººèƒ½çœŸæ­£â€œåŠ¨èµ·æ¥â€ã€‚

### **è®­ç»ƒé˜¶æ®µï¼š**

- è¾“å…¥ï¼š

  - å½“å‰å›¾åƒ
  - è¯­è¨€æŒ‡ä»¤ï¼ˆå¦‚â€œæŠŠç‰›å¥¶æ”¾è¿›æ°´æ§½â€ï¼‰

- æ¨¡å‹ç»“æ„ï¼š

  - æŠŠå›¾+è¯­è¨€é€è¿›åˆšåˆšé¢„è®­ç»ƒçš„ VLMï¼Œå¾—åˆ°æ½œåœ¨åŠ¨ä½œ tokenï¼ˆå¦‚ token 12ï¼‰
  - ç”¨ä¸€ä¸ªå°çš„ MLP æ¨¡å‹ï¼ˆLAPA æ¨¡å—ï¼‰ï¼ŒæŠŠ token æ˜ å°„ä¸ºçœŸå®åŠ¨ä½œ a_1ï¼šå¯ä»¥æ˜¯ Î”poseã€å…³èŠ‚è§’ç­‰

  

- **ç›®æ ‡æ˜¯æœ€å°åŒ–åŠ¨ä½œè¯¯å·®**ï¼šé¢„æµ‹åŠ¨ä½œ a_1 è¦æ¥è¿‘çœŸå®æ ‡ç­¾ï¼ˆé¥æ“ä½œæ•°æ®æä¾›çš„ï¼‰

### **æ¨ç†é˜¶æ®µï¼š**

- å’Œè®­ç»ƒä¸€æ ·ï¼Œåªæ˜¯æ­¤æ—¶æœºå™¨äººå¼€å§‹æ‰§è¡Œè¾“å‡ºçš„åŠ¨ä½œäº†ã€‚

## **âœ… æ€»ç»“ä¸‰å—ä¸­æ¯ä¸ªæ¨¡å‹ï¼š**

| **æ­¥éª¤** | **æ¨¡å‹å**                 | **è¾“å…¥**        | **è¾“å‡º**       | **è®­ç»ƒç›®æ ‡**              |
| -------- | -------------------------- | --------------- | -------------- | ------------------------- |
| Step 1   | Encoder + VQ-VAE Decoder   | å›¾åƒå¯¹ x_1, x_2 | æ½œåœ¨ token z_1 | é‡å»º x_2                  |
| Step 2   | VLM (vision-language model | å›¾åƒ + æŒ‡ä»¤     | é¢„æµ‹ token z_1 | ä¸ Step 1 è¾“å‡º token ä¸€è‡´ |
| Step 3   | LAPA æ¨¡å— (MLP)            | token z_1       | å®é™…åŠ¨ä½œ a_1   | æœ€å°åŒ–çœŸå®åŠ¨ä½œè¯¯å·®        |

ä½ æƒ³ä¸æƒ³æˆ‘ä»¬ç”»ä¸€ä¸ªå…·ä½“ä¾‹å­ï¼Œæ¯”å¦‚ï¼šâ€œæ‹¿èµ·ç“¶å­â€è¿™ä¸ªåŠ¨ä½œï¼Œä» Step1 åˆ° Step3 æ€ä¹ˆæµåŠ¨çš„ï¼Ÿæˆ–è€…æˆ‘ä»¬çœ‹ä¸€ä¸‹è®ºæ–‡é‡Œçš„å…¬å¼éƒ¨åˆ†å†è¿ä¸€ä¸‹ã€‚



## **ğŸ¯ Qï¼šè¿™ä¸ª VLM æ˜¯ç”¨å·²æœ‰æ¨¡å‹å¾®è°ƒçš„å—ï¼Ÿ**

### **âœ… ç­”æ¡ˆæ˜¯ï¼š**

### **æ˜¯çš„ï¼Œä»–ä»¬ç”¨çš„æ˜¯å·²æœ‰çš„å¤šæ¨¡æ€æ¨¡å‹ï¼ˆFrozen pre-trained VLMï¼‰è¿›è¡Œå¾®è°ƒ**ï¼Œè€Œä¸æ˜¯ä»å¤´è®­ç»ƒã€‚

### **ğŸ“– è®ºæ–‡é‡Œæ˜ç¡®å†™äº†ï¼š**

> â€œWe leverage a **frozen pre-trained visual encoder** (e.g., from CLIP or SigLIP) and a language model head to learn latent actions.â€

ä¹Ÿå°±æ˜¯è¯´ï¼Œä»–ä»¬ç”¨çš„ VLM æ˜¯ç±»ä¼¼äº CLIP çš„ç»“æ„ï¼š

- **è§†è§‰ç¼–ç å™¨** æ˜¯ä» CLIPã€SigLIP æˆ– ImageBind è¿ç§»è¿‡æ¥çš„ï¼ŒFrozenï¼ˆä¸æ›´æ–°å‚æ•°ï¼‰
- **è¯­è¨€æ¨¡å—ï¼ˆæ–‡æœ¬ç¼–ç å™¨ or Transformerï¼‰**ï¼Œå¯ä»¥æ˜¯å¾®è°ƒè¿‡çš„
- ç„¶å**æ¥ä¸€ä¸ªå°çš„ token åˆ†ç±»å¤´**ï¼Œè¾“å‡º codebook ä¸­çš„ token æ¦‚ç‡

